Sub Stocks() For Each ws In Worksheets            Dim WorksheetName As String                'Current row        Dim i As Long                'Start row        Dim j As Long                'Index counter to fill Ticker row        Dim TickerCount As Long                'Row column A        Dim RowA As Long                'Row column I        Dim RowI As Long                'Variable for percent change calculation        Dim PerChange As Double                'Greatest increase calculation        Dim GreatIncr As Double                'Greatest decrease calculation        Dim GreatDecr As Double                'Greatest total volume        Dim GreatVol As Double                'WorksheetName        WorksheetName = ws.Name                'Create titles        ws.Range("I1").Value = "Ticker"        ws.Range("J1").Value = "Yearly change"        ws.Range("K1").Value = "Percent change"        ws.Range("L1").Value = "Total stock volume"        ws.Range("O1").Value = "Ticker"        ws.Range("P1").Value = "Value"        ws.Cells(2, 14).Value = "Greatest % increase"        ws.Cells(3, 14).Value = "Greatest % decrease"        ws.Cells(4, 14).Value = "Greatest total volume"                'Set Counter to first row        TickerCount = 2                'Set start row to 2        j = 2                'Find the non-blank cell in column A        RowA = ws.Cells(Rows.Count, 1).End(xlUp).Row                            'Loop through rows            For i = 2 To RowA                            'Check if name change                If ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value Then                                'Write ticker in column I                ws.Cells(TickerCount, 9).Value = ws.Cells(i, 1).Value                                'Write yearly change in column J                ws.Cells(TickerCount, 10).Value = ws.Cells(i, 6).Value - ws.Cells(j, 3).Value                                    'Conditional formating                    If ws.Cells(TickerCount, 10).Value < 0 Then                                    'Background color red                    ws.Cells(TickerCount, 10).Interior.ColorIndex = 3                                    Else                                    'Background color green                    ws.Cells(TickerCount, 10).Interior.ColorIndex = 10                                    End If                                        'Write percent change in column K                    If ws.Cells(j, 3).Value <> 0 Then                    PerChange = ((ws.Cells(i, 6).Value - ws.Cells(j, 3).Value) / ws.Cells(j, 3).Value)                                        'Percentage formating                    ws.Cells(TickerCount, 11).Value = Format(PerChange, "Percent")                                        Else                                        ws.Cells(TickerCount, 11).Value = Format(0, "Percent")                                        End If                                    'Write total volume in column L                ws.Cells(TickerCount, 12).Value = WorksheetFunction.Sum(Range(ws.Cells(j, 7), ws.Cells(i, 7)))                                'Increase TickCount by 1                TickerCount = TickerCount + 1                                'Set the new start row of the ticker block                j = i + 1                                End If                        Next i                    'Find non-blank cell in column I        LastRowI = ws.Cells(Rows.Count, 9).End(xlUp).Row                       'Summary        GreatVol = ws.Cells(2, 12).Value        GreatIncr = ws.Cells(2, 11).Value        GreatDecr = ws.Cells(2, 11).Value                    'Loop for summary            For i = 2 To LastRowI                            'For greatest total volume, review if next value is larger, if yes take over a new value and write ws.Cells                If ws.Cells(i, 12).Value > GreatVol Then                GreatVol = ws.Cells(i, 12).Value                ws.Cells(4, 15).Value = ws.Cells(i, 9).Value                                Else                                GreatVol = GreatVol                                End If                                'For greatest increase, review if next value is larger, if yes take over a new value and write ws.Cells                If ws.Cells(i, 11).Value > GreatIncr Then                GreatIncr = ws.Cells(i, 11).Value                ws.Cells(2, 15).Value = ws.Cells(i, 9).Value                                Else                                GreatIncr = GreatIncr                                End If                                'For greatest decrease, check if next value is smaller, if yes take over a new value and write ws.Cells                If ws.Cells(i, 11).Value < GreatDecr Then                GreatDecr = ws.Cells(i, 11).Value                ws.Cells(3, 15).Value = ws.Cells(i, 9).Value                                Else                                GreatDecr = GreatDecr                                End If                            'Summary results in ws.Cells            ws.Cells(2, 16).Value = Format(GreatIncr, "Percent")            ws.Cells(3, 16).Value = Format(GreatDecr, "Percent")            ws.Cells(4, 16).Value = Format(GreatVol, "Scientific")                        Next i                            Next ws        End Sub